<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">

  <!-- PWA / iOS -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Rutas RELATIVAS, sin / al inicio -->
  <link rel="apple-touch-icon" href="images/icons/180.png" sizes="180x180">
  <link rel="apple-touch-icon-precomposed" href="images/icons/180.png">

  <title>Formulario PWA</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Manifest (ruta relativa) -->
  <link rel="manifest" href="mainmanifest.json">

  <!-- Bootstrap -->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css">

  <!-- Registro del Service Worker (ruta relativa) -->
  <script src="register.js"></script>
</head>

<body class="bg-dark text-light d-flex align-items-center" style="min-height: 100vh;">

  <main class="container">

    <!-- FORMULARIO -->
    <section class="card p-3 p-md-4 mx-auto col-11 col-sm-10 col-md-6 col-lg-4">
      <h2 class="mb-3 text-center">Registro de usuarios</h2>

      <form id="contactForm" novalidate>

        <div class="mb-2">
          <label for="name" class="form-label">Nombre</label>
          <input type="text" id="name" name="name" required placeholder="Tu nombre..." class="form-control">
        </div>

        <div class="mb-2">
          <label for="email" class="form-label">Correo electrónico</label>
          <input type="email" id="email" name="email" required placeholder="ejemplo@correo.com" class="form-control">
        </div>

        <div class="mb-3">
          <label for="age" class="form-label">Edad</label>
          <input type="number" id="age" name="age" required placeholder="Tu edad..." class="form-control">
        </div>

        <button type="button" id="savebtn" class="btn btn-primary w-100 mb-2" disabled>Enviar</button>

        <button type="button" id="listbtn" class="btn btn-secondary w-100">Listar</button>

      </form>

      <p id="mensaje-resultado" class="mt-2 text-center"></p>
    </section>

    <!-- LISTA DE USUARIOS -->
    <section class="mt-4 col-11 col-sm-10 col-md-8 mx-auto">
      <div id="userListContainer">
        <div id="userList" class="row justify-content-center"></div>
      </div>
    </section>

  </main>

  <!-- PouchDB -->
  <script src="https://cdn.jsdelivr.net/npm/pouchdb@9.0.0/dist/pouchdb.min.js"></script>

  <!-- Validación básica de formulario -->
  <script>
    document.addEventListener("DOMContentLoaded", () => {
      console.log("DOM cargado (script de validación)");

      const nameInput = document.getElementById("name");
      const emailInput = document.getElementById("email");
      const ageInput = document.getElementById("age");
      const saveBtn = document.getElementById("savebtn");

      function validarFormulario() {
        const nombreOK = nameInput.value.trim().length > 0;
        const emailOK = emailInput.value.trim().length > 0 && emailInput.checkValidity();
        const ageOK = ageInput.value.trim().length > 0;

        saveBtn.disabled = !(nombreOK && emailOK && ageOK);
      }

      nameInput.addEventListener("input", validarFormulario);
      emailInput.addEventListener("input", validarFormulario);
      ageInput.addEventListener("input", validarFormulario);

      validarFormulario();
    });
  </script>

  <!-- Lógica principal del formulario -->
  <script src="app.js"></script>

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>
